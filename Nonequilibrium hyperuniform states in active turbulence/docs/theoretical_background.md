# Theoretical Background: Active Flows and Hyperuniformity

This document outlines the theoretical foundation for the implementation of the active flow simulation and hyperuniformity analysis project. It covers the physics of active fluids, the mathematical models governing the flow, the numerical methods employed for solution, and the statistical tools used for analysis.

## 1. Active Flow

### 1.1 Definition
Active flows are generated by "active fluids" or "active matter"â€”materials composed of self-propelled entities (micro-swimmers) capable of converting stored energy (chemical, biological) into mechanical motion. Examples range from dense populations of bacteria (e.g., *Bacillus subtilis*) to schools of fish. 

Unlike conventional passive fluids where energy is supplied from boundaries or external fields, active fluids are driven by internal stresses generated by the individual swimmers. This internal forcing leads to complex behaviors, including "meso-scale turbulence" or "bacterial turbulence," characterized by chaotic flow patterns, jets, and vorticities.

### 1.2 Mathematical Model: Generalized Navier-Stokes
To simulate the collective motion of dense bacterial suspensions, we employ a continuum model that extends the standard Navier-Stokes equations. This coarse-grained model represents the solvent velocity field $\mathbf{u}(t, \mathbf{x})$ while effectively capturing the active stresses generated by the swimmers.

The governing equations for the incompressible velocity field $\mathbf{u}$ are:

$$
\begin{align}
\nabla \cdot \mathbf{u} &= 0 \\
\partial_t \mathbf{u} + (\mathbf{u} \cdot \nabla)\mathbf{u} + \nabla p &= \nabla \cdot \boldsymbol{\sigma}
\end{align}
$$

Where:
* $ \mathbf{u}(t, \mathbf{x}) $ is the velocity field,
* $ p(t, \mathbf{x}) $ is the pressure,
* $ \boldsymbol{\sigma} $ is a modified stress tensor encoding active forcing.


#### 1.2.1 Effective Viscosity
The crucial component of this model is the stress tensor $\sigma$, which introduces scale-dependent viscosity to mimic the activity of the swimmers. The divergence of the stress tensor is modeled as:

$$
\nabla \cdot \sigma = \nu_{\text{eff}} \Delta \mathbf{u}
$$

The effective viscosity operator $\nu_{\text{eff}}$ is defined in terms of the Laplacian $\Delta$:

$$
\nu_{\text{eff}} = \Gamma_0 - \Gamma_2 \Delta + \Gamma_4 \Delta^2
$$

In Fourier space (with wavenumber $k$), this operator becomes:

$$
\tilde{\nu}_{\text{eff}}(k) = \Gamma_0 + \Gamma_2 k^2 + \Gamma_4 k^4
$$

* **$\Gamma_0 > 0$**: Corresponds to the standard kinematic viscosity (damping).
* **$\Gamma_2 < 0$**: Acts as a negative viscosity at intermediate scales, injecting energy into the system and driving instability (representing bacterial activity).
* **$\Gamma_4 > 0$**: Hyperviscosity that damps small-scale fluctuations (high wavenumbers) to ensure stability.

#### 1.2.2 Piecewise Spectral Model
To gain precise control over the range and strength of the unstable modes, we adopt a piecewise representation of the effective viscosity in spectral space.

$$
\tilde{\nu}(k) = 
\begin{cases} 
\nu_0 > 0 & \text{for } k < k_{\text{min}} \\
\nu_1 < 0 & \text{for } k_{\text{min}} \le k \le k_{\text{max}} \\
\nu_2 > 0 & \text{for } k > k_{\text{max}}
\end{cases}
$$

* $\nu_1$ controls the **strength** of the bacterial forcing.
* $[k_{\text{min}}, k_{\text{max}}]$ determines the **range** of active scales.

## 2. Numerical Methods

### 2.1 Vorticity-Stream Function Formulation
To eliminate the pressure term and satisfy incompressibility automatically in 2D, the equations are recast into the vorticity-stream function formulation.

Defining vorticity $\omega = \nabla \times \mathbf{u}$ (scalar in 2D) and stream function $\psi$ such that $\mathbf{u} = (\partial_y \psi, -\partial_x \psi)$, the system becomes:

$$
\partial_t \omega + (\mathbf{u} \cdot \nabla)\omega = \nu_{\text{eff}} \Delta \omega
$$

With the Poisson equation linking stream function and vorticity:
$$
\Delta \psi = -\omega
$$

### 2.2 Pseudo-Spectral Method
The system is solved using a pseudo-spectral method with periodic boundary conditions.
1.  **Linear Terms**: The effective viscosity and Laplacian terms are computed exactly in Fourier space.
2.  **Non-Linear (Convective) Terms**: The term $(\mathbf{u} \cdot \nabla)\omega$ is computed using a pseudo-spectral approach to avoid expensive convolutions that have $ O(n \log n) $ complexity.
    * Compute $\mathbf{u}$ and $\nabla \omega$ in Fourier space.
    * Transform to real space using Inverse FFT.
    * Perform multiplication in real space.
    * Transform back to Fourier space.
    * *Note*: Dealiasing is applied using the $2/3$ rule to prevent spectral blocking.

### 2.3 Time Integration
Time stepping is performed using a **Runge-Kutta TVD (Total Variation Diminishing)** scheme, specifically a third-order explicit method. This scheme is robust for hyperbolic conservation laws and suitable for the stiff dynamics of turbulence.

An adaptive time-stepping controller (CFL controller) is used to ensure stability:
$$
\Delta t_n = C_{\text{CFL}} \min \left( \frac{\Delta x}{\max |\mathbf{u}|} \right)
$$

## 3. Hyperuniformity Analysis

### 3.1 Concept
Hyperuniformity is a state of matter characterized by an anomalous suppression of density fluctuations at large length scales. While the system may appear disordered locally (like a liquid), it exhibits order comparable to crystals at global scales.

### 3.2 Structure Factor
To detect hyperuniformity in the active flow, we analyze the spatial arrangement of **micro-vorticities** (local extrema of the vorticity field). The primary metric is the **Structure Factor** $S(\mathbf{k})$, defined as:

$$
S(\mathbf{k}) = \frac{|\tilde{n}(\mathbf{k})|^2}{N}
$$

Where:
* $\tilde{n}(\mathbf{k}) = \sum_{j=1}^{N} \exp(-i \mathbf{k} \cdot \mathbf{r}_j)$ is the Fourier transform of the particle density (micro-vorticities).
* $N$ is the total number of micro-vorticities.

### 3.3 Condition for Hyperuniformity
A system is considered hyperuniform if the structure factor vanishes as the wavenumber goes to zero:

$$
\lim_{|\mathbf{k}| \to 0} S(\mathbf{k}) = 0
$$

This implies that density fluctuations grow more slowly than the volume of the observation window. In the context of active flows, checking for hyperuniformity helps determine if the chaotic micro-vorticities self-organize into a "hidden" ordered state that drives large-scale flow patterns.